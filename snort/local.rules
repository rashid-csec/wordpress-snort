# --- ICMP and SSH Detection ---
alert icmp any any -> any any (msg:"ICMP Detected"; sid:1000001; rev:1;)
alert tcp any any -> any 22 (msg:"SSH Connection Attempt"; flags:S; sid:1000002; rev:1;)

# --- HTTP Access Detection ---
alert tcp any any -> any 80 (msg:"Possible HTTP Access"; content:"GET"; sid:1000004; rev:1;)

# --- WordPress Specific Rules ---
alert tcp any any -> any any (msg:"WordPress Login Page Access"; content:"/wp-login.php"; sid:1001001; rev:1;)
alert tcp any any -> any any (msg:"WordPress Admin Panel Access"; content:"/wp-admin"; sid:1001002; rev:1;)
alert tcp any any -> any any (msg:"WordPress Config Access Attempt"; content:"/wp-config.php"; sid:1001003; rev:1;)
alert tcp any any -> any any (msg:"WordPress XML-RPC Access"; content:"/xmlrpc.php"; sid:1001004; rev:1;)
alert tcp any any -> any any (msg:"WordPress File Upload Attempt"; content:"POST"; content:"/wp-content/uploads/"; sid:1001005; rev:1;)
alert tcp any any -> any any (msg:"WordPress Revslider Plugin Access"; content:"/wp-content/plugins/revslider/"; sid:1001006; rev:1;)

alert tcp any any -> any any (msg:"WordPress Theme Directory Access"; content:"/wp-content/themes/"; sid:1001008; rev:1;)
alert tcp any any -> any 80 (msg:"WordPress Login Error Detected"; content:"ERROR:"; content:"password you entered"; sid:1002010; rev:1;)

# --- Web Attack Signatures ---

## Local File Inclusion
alert tcp any any -> any 80 (msg:"Web Attack - LFI /etc/passwd"; content:"../../"; content:"etc/passwd"; sid:1002006; rev:1;)

## Remote File Inclusion
alert tcp any any -> any 80 (msg:"Web Attack - RFI with http://"; content:"http://"; nocase; sid:1002007; rev:1;)

## Shell Upload Attempt
alert tcp any any -> any 80 (msg:"Web Attack - PHP Webshell Upload Attempt"; content:".php"; nocase; content:"Content-Disposition"; content:"filename="; sid:1002008; rev:1;)

## Command Injection
alert tcp any any -> any 80 (msg:"Web Attack - Command Injection system("; content:"system("; nocase; sid:1002009; rev:1;)

## fail2ban
alert tcp any any -> $HOME_NET 80 (msg:"WordPress Bruteforce Attempt"; content:"POST"; content:"/wp-login.php"; threshold:type threshold, track by_src, count 5, seconds 30; sid:1006001; rev:1;)

## SQL
alert tcp any any -> $HOME_NET 80 (msg:"SQL Injection Attempt - ' OR 1=1"; content:"' OR 1=1"; nocase; sid:1002101; rev:1;)
alert tcp any any -> $HOME_NET 80 (msg:"SQL Injection Attempt - UNION SELECT"; content:"UNION SELECT"; nocase; sid:1002102; rev:1;)
alert tcp any any -> $HOME_NET 80 (msg:"SQL Injection Attempt - 1=1"; content:"1=1"; nocase; sid:1002103; rev:1;)
alert tcp any any -> $HOME_NET 80 (msg:"SQL Injection Attempt - information_schema"; content:"information_schema"; nocase; sid:1002104; rev:1;)

alert tcp any any -> $HOME_NET 80 (msg:"SQLi Attempt on wp-login.php"; flow:to_server,established; content:"POST"; http_method; content:"/wp-login.php"; http_uri; content:"' OR 1=1"; nocase; sid:1007001; rev:2;)

## XSS

alert tcp any any -> $HOME_NET 80 (msg:"XSS Attack Attempt - <script>"; content:"<script>"; nocase; sid:1002001; rev:1;)
alert tcp any any -> $HOME_NET 80 (msg:"XSS Attack Attempt - javascript:"; content:"javascript:"; nocase; sid:1002002; rev:1;)
alert tcp any any -> $HOME_NET 80 (msg:"XSS Attack Attempt - onerror="; content:"onerror="; nocase; sid:1002003; rev:1;)
alert tcp any any -> $HOME_NET 80 (msg:"XSS Attack Attempt - alert("; content:"alert("; nocase; sid:1002004; rev:1;)


alert tcp any any -> $HOME_NET 22 (msg:"SSH Brute Force Attempt"; flags:S; threshold:type threshold, track by_src, count 5, seconds 30; sid:1003008; rev:1;)
