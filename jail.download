#
# jail.local - customized Fail2Ban jail configuration
#

[DEFAULT]
# Ban time in seconds (10 minutes)
bantime  = 600
# Find time window in seconds (10 minutes)
findtime = 600
# Max retries before ban
maxretry = 5
backend  = auto
usedns   = warn
logencoding = auto
enabled  = false

# SSH server jail
[sshd]
enabled  = true
port     = ssh
logpath  = %(sshd_log)s
backend  = %(sshd_backend)s
maxretry = 5
bantime  = 1800
findtime = 60
# MySQL authentication jail
[mysqld-auth]
enabled  = true
port     = 3306
logpath  = /var/log/mysql/error.log
backend  = %(mysql_backend)s
maxretry = 5
bantime  = 1300

# WordPress login protection jail
[wordpress]
enabled  = true
port     = http,https
filter   = wordpress
logpath  = /var/log/apache2/access.log
maxretry = 5
bantime  = 1800
findtime = 60
backend  = auto

[snort-sql-injection]
enabled  = true
port     = http,https
filter   = snort-sql-injection
logpath  = /var/log/snort/snort.alert.fast
maxretry = 5
bantime  = 1800
findtime = 600
backend  = auto

[snort-xss]
enabled  = true
port     = http,https
filter   = snort-xss
logpath  = /var/log/snort/snort.alert.fast
maxretry = 5
bantime  = 3600
findtime = 600
backend  = auto

# (Optional: You need to create /etc/fail2ban/filter.d/wordpress.conf with correct regexes)

#
# Disabled default jails (examples from original)
#

[dropbear]
enabled = false
port = ssh
logpath = %(dropbear_log)s
backend = %(dropbear_backend)s

[selinux-ssh]
enabled = false
port = ssh
logpath = %(auditd_log)s

[apache-auth]
enabled = false
port = http,https
logpath = %(apache_error_log)s

[apache-badbots]
enabled = false
port = http,https
logpath = %(apache_access_log)s
bantime = 48h
maxretry = 1

# (Other apache/nginx/http related jails remain disabled by default)

# -- More jails below can be enabled as needed following this pattern --

# Example for recidive jail (persistent offenders)
[recidive]
enabled = false
logpath = /var/log/fail2ban.log
banaction = %(banaction_allports)s
bantime = 604800  ; 1 week
findtime = 86400  ; 1 day
maxretry = 5
